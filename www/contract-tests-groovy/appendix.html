<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<meta content="text/html; charset=windows-1250" http-equiv="content-type"><title>Groovy Contract Tests Manual - Attachments</title></head>
<body>&nbsp;&nbsp; &nbsp;
<div id="projecthome" class="app">
<pre>-&lt;( <a href="index.html">Contract tests manual</a> &gt; Appendix )&gt;-</pre>
<hr style="width: 100%; height: 2px;">
<h1>A) Appendix</h1>
Table of contents:<br>
<ul>
<li><a href="#rangendoc">A.1 Javadoc for
RandomGenerator pattern</a></li>
<li>A.2 Database table connector Groovy configuration files</li>
<ul>
<li><a href="#A.2.1">A.2.1
{$user.home}/.connectors/connector-databasetable/build.groovy</a></li>
<li><a href="#A.2.2">A.2.2
{$user.home}/.connectors/connector-databasetable/mysql/build.groovy</a></li>
<li><a href="#transtable">A.3 Table of
translation from the old configuration files</a></li>
</ul>
</ul>
<br>
<h2><a name="rangendoc"></a>A.1 Javadoc
for&nbsp;RandomGenerator pattern</h2>
<p><code>Lazy.random()</code> uses the pattern described further.</p>
<p>Random
generator uses a pattern to generate a random sequence based on given
pattern. The supported characters are (can appear in pattern string):</p>
<ul>
<li>&nbsp;# - numeric</li>
<li>a - lowercase letter</li>
<li>A - uppercase letter </li>
<li>? - lowercase and uppercase letter</li>
<li>. - any character<br>
</li>
</ul>
<br>
Any other character inside the pattern is directly printed to the
output. <br>
<br>
<span style="font-weight: bold;">Backslash</span><!-- ========================================= -->&nbsp;is
used to escape any character. For instance pattern "###\.##" prints a
floating point random number <br>
<hr style="width: 100%; height: 2px;">
<h2><a name="attachdbtableconfig">A.2 Database table
connector Groovy configuration files</a></h2>
<p>We will observe two groovy scripts used in database table
connector, one is generic, the second is specific for MySQL database,
contains connection username/password.</p>
<h3><a name="A.2.1"></a>A.2.1
{$user.home}/.connectors/connector-databasetable/build.groovy</h3>
<pre>
/*  +---------------------------------------------------+
 *  ----------- Contract Tests configuration ------------
 *  +---------------------------------------------------+ 
 */

import org.identityconnectors.contract.data.groovy.Lazy
import org.identityconnectors.contract.data.groovy.Random
import org.identityconnectors.contract.data.groovy.Get
import org.identityconnectors.contract.exceptions.ObjectNotFoundException;


// Connector WRONG configuration for ValidateApiOpTests
connector.i1.wrong.host=""
connector.i2.wrong.login=""
connector.i3.wrong.password=""


testsuite {
    // path to bundle jar - property is set by ant - leave it as it is
    bundleJar=System.getProperty("bundleJar")
    bundleName=System.getProperty("bundleName")
    bundleVersion=System.getProperty("bundleVersion")
    connectorName="org.identityconnectors.databasetable.DatabaseTableConnector"    

    // ValidateApiOpTests:
    Validate.iterations="3"

    // AuthenticationApiOpTests:
    Authentication.account.username=Lazy.get("i0.Authentication.account.@@NAME@@")
    Authentication.account.wrong.password="bogus"

    // SyncApiOpTests:
    Sync.disable.delete=true
    
    // SchemaApiOpTests:
    Schema.oclasses=['account']
    Schema.attributes.account.oclasses=['@@NAME@@', '@@PASSWORD@@', 'MANAGER', 'MIDDLENAME', 'FIRSTNAME', 'LASTNAME', 'EMAIL', 'DEPARTMENT', 'TITLE', 'AGE', 'SALARY', 'JPEGPHOTO']


    Schema."@@NAME@@".attribute.account.oclasses=[
                                                            type: 'java.lang.String',
                                                            readable: "true",
                                                            createable: "true",
                                                            updateable: "true",
                                                            required: "true",
                                                            multiValue: "false",
                                                            returnedByDefault: "true" 
                                              ]        

    Schema."@@PASSWORD@@".attribute.account.oclasses=[
                                                            type: "org.identityconnectors.common.security.GuardedString", 
                                                            readable: "false",
                                                            createable: "true",
                                                            updateable: "true", 
                                                            required: "true",
                                                            multiValue: "false",
                                                            returnedByDefault: "true"
                                             ]                                                        
    // many attributes have similar values                                                
    Schema.common.attribute=[
                                            type: "java.lang.String",
                                            readable: "true",
                                            createable: "true",
                                            updateable: "true",
                                            required: "false",
                                            multiValue: "false",
                                            returnedByDefault: "true"
                    ]                                        
    Schema.MIDDLENAME.attribute.account.oclasses=Lazy.get("testsuite.Schema.common.attribute")                                                        
    Schema.FIRSTNAME.attribute.account.oclasses=Lazy.get("testsuite.Schema.common.attribute")
    Schema.MANAGER.attribute.account.oclasses=Lazy.get("testsuite.Schema.common.attribute")                                                        
    Schema.EMAIL.attribute.account.oclasses=Lazy.get("testsuite.Schema.common.attribute")                                                                                                                                                                                                                                                                                                                                                         
    Schema.DEPARTMENT.attribute.account.oclasses=Lazy.get("testsuite.Schema.common.attribute")
    Schema.TITLE.attribute.account.oclasses=Lazy.get("testsuite.Schema.common.attribute")                                                                                                                                                                        
    Schema.LASTNAME.attribute.account.oclasses=Lazy.get("testsuite.Schema.common.attribute")                                        

    Schema.AGE.attribute.account.oclasses=[
                                                        type: "java.lang.Integer",
                                                        readable: "true",
                                                        createable: "true",
                                                        updateable: "true",
                                                        required: "false",
                                                        multiValue: "false",
                                                        returnedByDefault: "true"
                                ]                                        
                                                                                                    
    Schema.SALARY.attribute.account.oclasses=[
                                                            type: "java.math.BigDecimal",
                                                            readable: "true",
                                                            createable: "true",
                                                            updateable: "true",
                                                            required: "false",
                                                            multiValue: "false",
                                                            returnedByDefault: "true"
                                   ]                                         
                                                                                                                                                                                                                                                                                                                                                                        
    Schema.JPEGPHOTO.attribute.account.oclasses=[
                                                            type: "[B",
                                                            readable: "true",
                                                            createable: "true",
                                                            updateable: "true",
                                                            required: "false",
                                                            multiValue: "false",
                                                            returnedByDefault: "false"
                                                        ]

    // object classes supported by operations                                                                                                              
    Schema.operations=[
                                    GetApiOp: ['account'],
                                    SchemaApiOp: ['account'],
                                    ValidateApiOp: ['account'],
                                    CreateApiOp: ['account'],
                                    SearchApiOp: ['account'],
                                    DeleteApiOp: ['account'],
                                    ScriptOnConnectorApiOp: ['account'],
                                    UpdateApiOp: ['account'],
                                    AuthenticationApiOp: ['account'],
                                    TestApiOp: ['account'],
                                    SyncApiOp: [] // sync column is missing in the tables.
                ]
  
} // testsuite


// ATTRIBUTES' VALUES:
// longer bytearray value
JPEGPHOTO=Lazy.random("????????????????????????????????????????", byte[].class)
</pre>
<br>
<h3><a name="A.2.2"></a>A.2.2
{$user.home}/.connectors/connector-databasetable/mysql/build.groovy</h3>
<p>Contains the database specific credentials.</p>
<pre>
/*  +---------------------------------------------------+
 *  ----------- Contract Tests configuration ------------
 *  +---------------------------------------------------+ 
 */

import org.identityconnectors.contract.data.groovy.Lazy
import org.identityconnectors.contract.data.groovy.Random
import org.identityconnectors.contract.data.groovy.Get
import org.identityconnectors.contract.exceptions.ObjectNotFoundException;

// Connector configuration
connector{
    driver="com.mysql.jdbc.Driver"
    keyColumn="ACCOUNTID"
    passwordColumn="PASSWORD"
    DBTable="idm_sync"
    connectionUrl="jdbc:mysql://localhost/database"
    login="loginname"
    password="password"
}
</pre>
<hr style="width: 100%; height: 2px;">
<h2>&nbsp;<a name="transtable"></a>A.3
Table of translation from the old configuration
files</h2>
<br>
<table style="text-align: left; width: 100%;" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td style="background-color: rgb(204, 204, 255);">DefaultDataProvider
-- using legacy macros</td>
<td style="background-color: rgb(204, 204, 255);">GroovyDataProvider
-- simple way to achieve anything</td>
</tr>
<tr>
<td>typenames such as: <span style="font-family: monospace;">string</span>, <span style="font-family: monospace;">integer</span>, <span style="font-family: monospace;">float,long</span>...</td>
<td>@deprecated <br>
They are no longer needed in Groovy (implicit typing given by
expression on the right side of assignment).<br>
Exceptionally, if it is needed to use these with prefix&nbsp;T,
such as Tstring etc.</td>
</tr>
<tr>
<td><span style="font-family: monospace;">${RANDOM,
AAAAA##}</span></td>
<td><span style="font-family: monospace;">Lazy.random("AAAAA##")</span></td>
</tr>
<tr>
<td>
<pre>${LONG, ${RANDOM, #####}}</pre>
</td>
<td>
<pre>Lazy.random("#####", Long.class)</pre>
</td>
</tr>
<tr>
<td><span style="font-family: monospace;">foo=</span><span style="font-family: monospace;">${NOTSUPPLIED}</span></td>
<td><span style="font-family: monospace;">foo=new
ObjectNotFoundException()</span></td>
</tr>
<tr>
<td><span style="font-family: monospace;">${FLOAT,
${RANDOM, #####}${LITERAL, .}${RANDOM, ##}}</span></td>
<td><span style="font-family: monospace;">Lazy.random("#####\\.##",
Float.class)</span></td>
</tr>
<tr>
<td><span style="font-family: monospace;">list=${LIST,
item1, item2}</span></td>
<td><span style="font-family: monospace;">list
= ["item1", "item2"]</span></td>
</tr>
<tr>
<td><span style="font-family: monospace;">multiString=${LIST,
${RANDOM, AAAAA##}, ${RANDOM, AAAAA##}}</span></td>
<td><span style="font-family: monospace;">multiString=[Lazy.random("AAAAA##")
, Lazy.random("AAAAA##")]</span></td>
</tr>
<tr>
<td><span style="font-family: monospace;">map=${MAP,
<br>
&nbsp; ${MAPENTRY, SchemaApiOp, ${LIST, account}}<br>
}</span> </td>
<td><span style="font-family: monospace;">map=[<br>
&nbsp; SchemaApiOp : ["account"]<br>
]<br>
</span> </td>
</tr>
<tr>
<td>A string array:<span style="font-family: monospace;"> targetNames.connector.stringarray=${ARRAY, java.lang.String, spml2-DSML-Target}</span>
</td>
<td><span style="font-family: monospace;">connector.targetNames=new String[2]; connector.targetNames[0] = "java.lang.String"; connector.targetName[1] = "spml2-DSML-Target";</span>
</td>
</tr>
<tr>
<td>account.modified.string={$NOTSUPPLIED}</td>
<td>modified.account=new ObjectNotFoundException()</td>
</tr>
</tbody>
</table>
</div>
</body></html>